\doxysection{src/protocol\+\_\+api.h File Reference}
\hypertarget{protocol__api_8h}{}\label{protocol__api_8h}\index{src/protocol\_api.h@{src/protocol\_api.h}}


Header file containing functions and constants for SAP protocol operations (MLWE PQ SAP).  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include "{}params.\+h"{}}\newline
{\ttfamily \#include "{}poly.\+h"{}}\newline
{\ttfamily \#include "{}polyvec.\+h"{}}\newline
{\ttfamily \#include "{}indcpa.\+h"{}}\newline
{\ttfamily \#include "{}kem.\+h"{}}\newline
{\ttfamily \#include "{}fips202.\+h"{}}\newline
{\ttfamily \#include "{}fips202x4.\+h"{}}\newline
Include dependency graph for protocol\+\_\+api.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{protocol__api_8h_ad5efc07c6661656b396c6c3e859e0e74}{PUBLIC\+\_\+\+KEY\+\_\+\+BYTES}}~\mbox{\hyperlink{params_8h_a7663b32715a32f12eb70420793753ce3}{KYBER\+\_\+\+PUBLICKEYBYTES}}
\begin{DoxyCompactList}\small\item\em Number of bytes in a public key. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{protocol__api_8h_a84c301f8e1f57a825bbd2dcab697fc5e}{CIPHERTEXT\+\_\+\+BYTES}}~\mbox{\hyperlink{params_8h_a356cca49fc302b0c34c18f4bbda6e5fe}{KYBER\+\_\+\+CIPHERTEXTBYTES}}
\begin{DoxyCompactList}\small\item\em Number of bytes in a ciphertext. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{protocol__api_8h_ab3f2c416c5b669c62894a54d8c26c33b}{SECRET\+\_\+\+KEY\+\_\+\+BYTES}}~\mbox{\hyperlink{params_8h_a7f9a2f9ae6937442f988816af97babb3}{KYBER\+\_\+\+SECRETKEYBYTES}}
\begin{DoxyCompactList}\small\item\em Number of bytes in a secret key. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{protocol__api_8h_ac42ee8dc097e52d63dd4e8371d769d12}{STEALTH\+\_\+\+ADDRESS\+\_\+\+BYTES}}~(\mbox{\hyperlink{params_8h_a1e66e19d25aceeae49d1184a077f92db}{KYBER\+\_\+K}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{params_8h_af66bcd4f5c1ee3377ed637b38ed8f356}{KYBER\+\_\+\+POLYBYTES}})
\begin{DoxyCompactList}\small\item\em Number of bytes in a stealth address. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{protocol__api_8h_a0666dc127dc023e0ab7c99df84cee1c6}{SS\+\_\+\+BYTES}}~\mbox{\hyperlink{params_8h_a5054c9269277412d8536eb82cfffbe15}{KYBER\+\_\+\+SSBYTES}}
\begin{DoxyCompactList}\small\item\em Number of bytes in a shared secret. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{protocol__api_8h_a2a804d61df9a40fc309e6c609739110d}{calculate\+\_\+stealth\+\_\+pub\+\_\+key}} (uint8\+\_\+t stealth\+\_\+pub\+\_\+key\mbox{[}(\mbox{\hyperlink{params_8h_a1e66e19d25aceeae49d1184a077f92db}{KYBER\+\_\+K}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{params_8h_af66bcd4f5c1ee3377ed637b38ed8f356}{KYBER\+\_\+\+POLYBYTES}})\mbox{]}, const uint8\+\_\+t ss\mbox{[}\mbox{\hyperlink{params_8h_a132bbc78e88ea5e14e93e0963dd5d0f9}{KYBER\+\_\+\+SYMBYTES}}\mbox{]}, const uint8\+\_\+t k\+\_\+pub\mbox{[}\mbox{\hyperlink{params_8h_a4c9f2345946a0d01dc2051b493c2bda4}{KYBER\+\_\+\+INDCPA\+\_\+\+PUBLICKEYBYTES}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Calculates the public key of the stealth address. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{protocol__api_8h_a858f8d44b117050df006c629482959fc}{recipient\+\_\+computes\+\_\+stealth\+\_\+pub\+\_\+key}} (uint8\+\_\+t stealth\+\_\+pub\+\_\+key\mbox{[}(\mbox{\hyperlink{params_8h_a1e66e19d25aceeae49d1184a077f92db}{KYBER\+\_\+K}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{params_8h_af66bcd4f5c1ee3377ed637b38ed8f356}{KYBER\+\_\+\+POLYBYTES}})\mbox{]}, const uint8\+\_\+t k\+\_\+pub\mbox{[}\mbox{\hyperlink{params_8h_a7663b32715a32f12eb70420793753ce3}{KYBER\+\_\+\+PUBLICKEYBYTES}}\mbox{]}, const uint8\+\_\+t ephemeral\+\_\+pub\+\_\+key\mbox{[}\mbox{\hyperlink{params_8h_a356cca49fc302b0c34c18f4bbda6e5fe}{KYBER\+\_\+\+CIPHERTEXTBYTES}}\mbox{]}, const uint8\+\_\+t v\mbox{[}\mbox{\hyperlink{params_8h_a7f9a2f9ae6937442f988816af97babb3}{KYBER\+\_\+\+SECRETKEYBYTES}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Computes the stealth public key by the recipient. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{protocol__api_8h_a741d56808420f6e2ee9e851f4122dae0}{sender\+\_\+computes\+\_\+stealth\+\_\+pub\+\_\+key\+\_\+and\+\_\+viewtag}} (uint8\+\_\+t stealth\+\_\+pub\+\_\+key\mbox{[}(\mbox{\hyperlink{params_8h_a1e66e19d25aceeae49d1184a077f92db}{KYBER\+\_\+K}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{params_8h_af66bcd4f5c1ee3377ed637b38ed8f356}{KYBER\+\_\+\+POLYBYTES}})\mbox{]}, uint8\+\_\+t ephemeral\+\_\+pub\+\_\+key\mbox{[}\mbox{\hyperlink{params_8h_a356cca49fc302b0c34c18f4bbda6e5fe}{KYBER\+\_\+\+CIPHERTEXTBYTES}}\mbox{]}, uint8\+\_\+t \texorpdfstring{$\ast$}{*}view\+\_\+tag, const uint8\+\_\+t v\+\_\+pub\mbox{[}\mbox{\hyperlink{params_8h_a7663b32715a32f12eb70420793753ce3}{KYBER\+\_\+\+PUBLICKEYBYTES}}\mbox{]}, const uint8\+\_\+t k\+\_\+pub\mbox{[}\mbox{\hyperlink{params_8h_a7663b32715a32f12eb70420793753ce3}{KYBER\+\_\+\+PUBLICKEYBYTES}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Computes the stealth public key and view tag by the sender. \end{DoxyCompactList}\item 
uint8\+\_\+t \mbox{\hyperlink{protocol__api_8h_a9a43976b56c90c6d13ef53bda55a3d34}{calculate\+\_\+view\+\_\+tag}} (const uint8\+\_\+t ss\mbox{[}\mbox{\hyperlink{params_8h_a5054c9269277412d8536eb82cfffbe15}{KYBER\+\_\+\+SSBYTES}}\mbox{]})
\begin{DoxyCompactList}\small\item\em Calculates a view tag from a shared secret. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Header file containing functions and constants for SAP protocol operations (MLWE PQ SAP). 

This file provides the function declarations and macro definitions needed for both sender and recipient to complete stealth address generation and key exchanges according to the SAP protocol based on Kyber primitives. 

\doxysubsection{Macro Definition Documentation}
\Hypertarget{protocol__api_8h_a84c301f8e1f57a825bbd2dcab697fc5e}\label{protocol__api_8h_a84c301f8e1f57a825bbd2dcab697fc5e} 
\index{protocol\_api.h@{protocol\_api.h}!CIPHERTEXT\_BYTES@{CIPHERTEXT\_BYTES}}
\index{CIPHERTEXT\_BYTES@{CIPHERTEXT\_BYTES}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{CIPHERTEXT\_BYTES}{CIPHERTEXT\_BYTES}}
{\footnotesize\ttfamily \#define CIPHERTEXT\+\_\+\+BYTES~\mbox{\hyperlink{params_8h_a356cca49fc302b0c34c18f4bbda6e5fe}{KYBER\+\_\+\+CIPHERTEXTBYTES}}}



Number of bytes in a ciphertext. 

\Hypertarget{protocol__api_8h_ad5efc07c6661656b396c6c3e859e0e74}\label{protocol__api_8h_ad5efc07c6661656b396c6c3e859e0e74} 
\index{protocol\_api.h@{protocol\_api.h}!PUBLIC\_KEY\_BYTES@{PUBLIC\_KEY\_BYTES}}
\index{PUBLIC\_KEY\_BYTES@{PUBLIC\_KEY\_BYTES}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{PUBLIC\_KEY\_BYTES}{PUBLIC\_KEY\_BYTES}}
{\footnotesize\ttfamily \#define PUBLIC\+\_\+\+KEY\+\_\+\+BYTES~\mbox{\hyperlink{params_8h_a7663b32715a32f12eb70420793753ce3}{KYBER\+\_\+\+PUBLICKEYBYTES}}}



Number of bytes in a public key. 

\Hypertarget{protocol__api_8h_ab3f2c416c5b669c62894a54d8c26c33b}\label{protocol__api_8h_ab3f2c416c5b669c62894a54d8c26c33b} 
\index{protocol\_api.h@{protocol\_api.h}!SECRET\_KEY\_BYTES@{SECRET\_KEY\_BYTES}}
\index{SECRET\_KEY\_BYTES@{SECRET\_KEY\_BYTES}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{SECRET\_KEY\_BYTES}{SECRET\_KEY\_BYTES}}
{\footnotesize\ttfamily \#define SECRET\+\_\+\+KEY\+\_\+\+BYTES~\mbox{\hyperlink{params_8h_a7f9a2f9ae6937442f988816af97babb3}{KYBER\+\_\+\+SECRETKEYBYTES}}}



Number of bytes in a secret key. 

\Hypertarget{protocol__api_8h_a0666dc127dc023e0ab7c99df84cee1c6}\label{protocol__api_8h_a0666dc127dc023e0ab7c99df84cee1c6} 
\index{protocol\_api.h@{protocol\_api.h}!SS\_BYTES@{SS\_BYTES}}
\index{SS\_BYTES@{SS\_BYTES}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{SS\_BYTES}{SS\_BYTES}}
{\footnotesize\ttfamily \#define SS\+\_\+\+BYTES~\mbox{\hyperlink{params_8h_a5054c9269277412d8536eb82cfffbe15}{KYBER\+\_\+\+SSBYTES}}}



Number of bytes in a shared secret. 

\Hypertarget{protocol__api_8h_ac42ee8dc097e52d63dd4e8371d769d12}\label{protocol__api_8h_ac42ee8dc097e52d63dd4e8371d769d12} 
\index{protocol\_api.h@{protocol\_api.h}!STEALTH\_ADDRESS\_BYTES@{STEALTH\_ADDRESS\_BYTES}}
\index{STEALTH\_ADDRESS\_BYTES@{STEALTH\_ADDRESS\_BYTES}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{STEALTH\_ADDRESS\_BYTES}{STEALTH\_ADDRESS\_BYTES}}
{\footnotesize\ttfamily \#define STEALTH\+\_\+\+ADDRESS\+\_\+\+BYTES~(\mbox{\hyperlink{params_8h_a1e66e19d25aceeae49d1184a077f92db}{KYBER\+\_\+K}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{params_8h_af66bcd4f5c1ee3377ed637b38ed8f356}{KYBER\+\_\+\+POLYBYTES}})}



Number of bytes in a stealth address. 



\doxysubsection{Function Documentation}
\Hypertarget{protocol__api_8h_a2a804d61df9a40fc309e6c609739110d}\label{protocol__api_8h_a2a804d61df9a40fc309e6c609739110d} 
\index{protocol\_api.h@{protocol\_api.h}!calculate\_stealth\_pub\_key@{calculate\_stealth\_pub\_key}}
\index{calculate\_stealth\_pub\_key@{calculate\_stealth\_pub\_key}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{calculate\_stealth\_pub\_key()}{calculate\_stealth\_pub\_key()}}
{\footnotesize\ttfamily void calculate\+\_\+stealth\+\_\+pub\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{stealth\+\_\+pub\+\_\+key\mbox{[}(\+KYBER\+\_\+\+K \texorpdfstring{$\ast$}{*}\+KYBER\+\_\+\+POLYBYTES)\mbox{]},  }\item[{const uint8\+\_\+t}]{ss\mbox{[}\+KYBER\+\_\+\+SYMBYTES\mbox{]},  }\item[{const uint8\+\_\+t}]{k\+\_\+pub\mbox{[}\+KYBER\+\_\+\+INDCPA\+\_\+\+PUBLICKEYBYTES\mbox{]} }\end{DoxyParamCaption})}



Calculates the public key of the stealth address. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em stealth\+\_\+pub\+\_\+key} & Array where the computed stealth public key will be stored (STEALTH\+\_\+\+ADDRESS\+\_\+\+BYTES). \\
\hline
\mbox{\texttt{ in}}  & {\em ss} & Shared secret derived from key exchange. \\
\hline
\mbox{\texttt{ in}}  & {\em k\+\_\+pub} & Recipient\textquotesingle{}s public spending key (KYBER\+\_\+\+INDCPA\+\_\+\+PUBLICKEYBYTES).\\
\hline
\end{DoxyParams}
Calculates the public key of the stealth address.


\begin{DoxyEnumerate}
\item Initializes polyvec structures.
\begin{DoxyItemize}
\item This step initializes the polyvec structures pkpv and skpv. These structures hold polynomial vectors, and each polynomial is essentially a vector of coefficients used in lattice-\/based cryptography.\+The public\+\_\+seed is initialized to zero here, which will later be used to derive the public key.
\end{DoxyItemize}
\item Unpacks recipient\textquotesingle{}s public key using \doxylink{indcpa_8h_a0b1c9afb8ba4870a733d4f675c8028a9}{unpack\+\_\+pk(\&pkpv, public\+\_\+seed, k\+\_\+pub)} .The unpacked public key is stored in {\ttfamily pkpv}.
\item Derives matrix A deterministically using \doxylink{indcpa_8h_a95867e1475dc47314959ced95627df2c}{gen\+\_\+matrix(a, public\+\_\+seed, 0)} .
\begin{DoxyItemize}
\item The \doxylink{indcpa_8h_a95867e1475dc47314959ced95627df2c}{gen\+\_\+matrix()} function fills in the matrix a with polynomials where the coefficients are derived from a cryptographic randomness function \doxylink{symmetric_8h_a6e88e8a31d1cc278f777a453e22d35f5}{xof\+\_\+squeezeblocks()}
\end{DoxyItemize}
\item Converts shared secret into a noise sampled secret key vector {\ttfamily skpv} using \doxylink{poly_8h_a7acff2171f8515dcda521e0abce1f164}{poly\+\_\+getnoise\+\_\+eta1()} .
\item Computes A \texorpdfstring{$\ast$}{*} S + K polynomial vector\+:
\begin{DoxyItemize}
\item Calls \doxylink{polyvec_8h_a5ef9e3b32a6e413955076778ca9f056f}{polyvec\+\_\+basemul\+\_\+acc\+\_\+montgomery()} and \doxylink{poly_8h_a245ca8de277f9a977284c692163f3f93}{poly\+\_\+tomont()} for each element.
\end{DoxyItemize}
\item Adds original public key polynomial and reduces ( \doxylink{polyvec_8h_afeba48290257815f6213f9812426fe8d}{polyvec\+\_\+add(\&p\+\_\+poly, \&p\+\_\+poly, \&pkpv)} \doxylink{polyvec_8h_a0ee7c5915d658a6b2d9e69c62aa35162}{polyvec\+\_\+reduce(\&p\+\_\+poly)} ).
\item Converts resulting polynomial vector into byte array using \doxylink{polyvec_8h_a68bc449baca16c3d14c221146fed8a62}{polyvec\+\_\+tobytes(stealth\+\_\+pub\+\_\+key, \&p\+\_\+poly)}.
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em stealth\+\_\+pub\+\_\+key} & Output array for stealth public key. \\
\hline
\mbox{\texttt{ in}}  & {\em ss} & Shared secret. \\
\hline
\mbox{\texttt{ in}}  & {\em k\+\_\+pub} & Recipient\textquotesingle{}s public spending key. \\
\hline
\end{DoxyParams}
\Hypertarget{protocol__api_8h_a9a43976b56c90c6d13ef53bda55a3d34}\label{protocol__api_8h_a9a43976b56c90c6d13ef53bda55a3d34} 
\index{protocol\_api.h@{protocol\_api.h}!calculate\_view\_tag@{calculate\_view\_tag}}
\index{calculate\_view\_tag@{calculate\_view\_tag}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{calculate\_view\_tag()}{calculate\_view\_tag()}}
{\footnotesize\ttfamily uint8\+\_\+t calculate\+\_\+view\+\_\+tag (\begin{DoxyParamCaption}\item[{const uint8\+\_\+t}]{ss\mbox{[}\+KYBER\+\_\+\+SSBYTES\mbox{]} }\end{DoxyParamCaption})}



Calculates a view tag from a shared secret. 

The view tag is used to quickly identify transactions meant for the recipient.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ss} & Shared secret. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
View tag as a single byte.
\end{DoxyReturn}
Calculates a view tag from a shared secret.


\begin{DoxyEnumerate}
\item Calls \doxylink{fips202_8h_a503922aece24ae8b03030593676c4ce2}{shake128(hash, 32, ss, KYBER\+\_\+\+SSBYTES)} to hash the shared secret into 32 bytes.
\item Takes the first byte of the hash as the view tag.
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ss} & Shared secret. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t View tag (single byte). 
\end{DoxyReturn}
\Hypertarget{protocol__api_8h_a858f8d44b117050df006c629482959fc}\label{protocol__api_8h_a858f8d44b117050df006c629482959fc} 
\index{protocol\_api.h@{protocol\_api.h}!recipient\_computes\_stealth\_pub\_key@{recipient\_computes\_stealth\_pub\_key}}
\index{recipient\_computes\_stealth\_pub\_key@{recipient\_computes\_stealth\_pub\_key}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{recipient\_computes\_stealth\_pub\_key()}{recipient\_computes\_stealth\_pub\_key()}}
{\footnotesize\ttfamily void recipient\+\_\+computes\+\_\+stealth\+\_\+pub\+\_\+key (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{stealth\+\_\+pub\+\_\+key\mbox{[}(\+KYBER\+\_\+\+K \texorpdfstring{$\ast$}{*}\+KYBER\+\_\+\+POLYBYTES)\mbox{]},  }\item[{const uint8\+\_\+t}]{k\+\_\+pub\mbox{[}\+KYBER\+\_\+\+PUBLICKEYBYTES\mbox{]},  }\item[{const uint8\+\_\+t}]{ephemeral\+\_\+pub\+\_\+key\mbox{[}\+KYBER\+\_\+\+CIPHERTEXTBYTES\mbox{]},  }\item[{const uint8\+\_\+t}]{v\mbox{[}\+KYBER\+\_\+\+SECRETKEYBYTES\mbox{]} }\end{DoxyParamCaption})}



Computes the stealth public key by the recipient. 

The recipient uses their secret view key and the sender\textquotesingle{}s ephemeral public key to compute the stealth address.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em stealth\+\_\+pub\+\_\+key} & Array where the computed stealth public key will be stored. \\
\hline
\mbox{\texttt{ in}}  & {\em k\+\_\+pub} & Sender\textquotesingle{}s public key. \\
\hline
\mbox{\texttt{ in}}  & {\em ephemeral\+\_\+pub\+\_\+key} & Sender\textquotesingle{}s ephemeral public key. \\
\hline
\mbox{\texttt{ in}}  & {\em v} & Recipient\textquotesingle{}s secret view key.\\
\hline
\end{DoxyParams}
Computes the stealth public key by the recipient.


\begin{DoxyEnumerate}
\item Calls \doxylink{kem_8h_a08dbb674e5d520aca994bc4472ce5a02}{crypto\+\_\+kem\+\_\+dec(ss, ephemeral\+\_\+pub\+\_\+key, v)} to derive shared secret {\ttfamily ss} from ephemeral public key and private key {\ttfamily v}.
\item Prints recipient\textquotesingle{}s public key and derived shared secret.
\item Calls \doxylink{protocol__api_8h_a2a804d61df9a40fc309e6c609739110d}{calculate\+\_\+stealth\+\_\+pub\+\_\+key()} to compute stealth public key using public key {\ttfamily k\+\_\+pub} and shared secret {\ttfamily ss}. The resulting stealth public key is written into the output parameter {\ttfamily stealth\+\_\+pub\+\_\+key}.
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em stealth\+\_\+pub\+\_\+key} & Output array for the computed stealth public key. \\
\hline
\mbox{\texttt{ in}}  & {\em k\+\_\+pub} & Recipient\textquotesingle{}s public spending key. \\
\hline
\mbox{\texttt{ in}}  & {\em ephemeral\+\_\+pub\+\_\+key} & Ephemeral public key received from the sender. \\
\hline
\mbox{\texttt{ in}}  & {\em v} & Recipient\textquotesingle{}s private "{}view"{} key. \\
\hline
\end{DoxyParams}
\Hypertarget{protocol__api_8h_a741d56808420f6e2ee9e851f4122dae0}\label{protocol__api_8h_a741d56808420f6e2ee9e851f4122dae0} 
\index{protocol\_api.h@{protocol\_api.h}!sender\_computes\_stealth\_pub\_key\_and\_viewtag@{sender\_computes\_stealth\_pub\_key\_and\_viewtag}}
\index{sender\_computes\_stealth\_pub\_key\_and\_viewtag@{sender\_computes\_stealth\_pub\_key\_and\_viewtag}!protocol\_api.h@{protocol\_api.h}}
\doxysubsubsection{\texorpdfstring{sender\_computes\_stealth\_pub\_key\_and\_viewtag()}{sender\_computes\_stealth\_pub\_key\_and\_viewtag()}}
{\footnotesize\ttfamily void sender\+\_\+computes\+\_\+stealth\+\_\+pub\+\_\+key\+\_\+and\+\_\+viewtag (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{stealth\+\_\+pub\+\_\+key\mbox{[}(\+KYBER\+\_\+\+K \texorpdfstring{$\ast$}{*}\+KYBER\+\_\+\+POLYBYTES)\mbox{]},  }\item[{uint8\+\_\+t}]{ephemeral\+\_\+pub\+\_\+key\mbox{[}\+KYBER\+\_\+\+CIPHERTEXTBYTES\mbox{]},  }\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{view\+\_\+tag,  }\item[{const uint8\+\_\+t}]{v\+\_\+pub\mbox{[}\+KYBER\+\_\+\+PUBLICKEYBYTES\mbox{]},  }\item[{const uint8\+\_\+t}]{k\+\_\+pub\mbox{[}\+KYBER\+\_\+\+PUBLICKEYBYTES\mbox{]} }\end{DoxyParamCaption})}



Computes the stealth public key and view tag by the sender. 

The sender generates an ephemeral key pair, derives a shared secret, computes the stealth address, and extracts a view tag.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em stealth\+\_\+pub\+\_\+key} & Array where the computed stealth public key will be stored. \\
\hline
\mbox{\texttt{ out}}  & {\em ephemeral\+\_\+pub\+\_\+key} & Array where the ephemeral public key will be stored. \\
\hline
\mbox{\texttt{ out}}  & {\em view\+\_\+tag} & Computed view tag. \\
\hline
\mbox{\texttt{ in}}  & {\em v\+\_\+pub} & Recipient\textquotesingle{}s public view key. \\
\hline
\mbox{\texttt{ in}}  & {\em k\+\_\+pub} & Sender\textquotesingle{}s public key.\\
\hline
\end{DoxyParams}
Computes the stealth public key and view tag by the sender.


\begin{DoxyEnumerate}
\item Validates input.
\item Calls \doxylink{kem_8h_a34799e9bffdfd9786a5fcd8867837c74}{crypto\+\_\+kem\+\_\+enc(ephemeral\+\_\+pub\+\_\+key, ss, v\+\_\+pub)} to generate shared secret {\ttfamily ss} and ephemeral public key.
\item Prints sender\textquotesingle{}s public key and derived shared secret.
\item Calls \doxylink{protocol__api_8h_a2a804d61df9a40fc309e6c609739110d}{calculate\+\_\+stealth\+\_\+pub\+\_\+key()} to compute stealth public key using public key {\ttfamily k\+\_\+pub} and shared secret {\ttfamily ss}. The resulting stealth public key is written into the output parameter {\ttfamily stealth\+\_\+pub\+\_\+key}.
\item Calls \doxylink{protocol__api_8h_a9a43976b56c90c6d13ef53bda55a3d34}{calculate\+\_\+view\+\_\+tag()} to compute view tag from shared secret {\ttfamily ss}.
\end{DoxyEnumerate}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em stealth\+\_\+pub\+\_\+key} & Output array for computed stealth public key. \\
\hline
\mbox{\texttt{ out}}  & {\em ephemeral\+\_\+pub\+\_\+key} & Output ephemeral public key (to be sent to recipient). \\
\hline
\mbox{\texttt{ out}}  & {\em view\+\_\+tag} & Output computed view tag (single byte). \\
\hline
\mbox{\texttt{ in}}  & {\em v\+\_\+pub} & Recipient\textquotesingle{}s public "{}view"{} key. \\
\hline
\mbox{\texttt{ in}}  & {\em k\+\_\+pub} & Recipient\textquotesingle{}s public "{}spending"{} key. \\
\hline
\end{DoxyParams}
