\doxysection{libs/symmetric.h File Reference}
\hypertarget{symmetric_8h}{}\label{symmetric_8h}\index{libs/symmetric.h@{libs/symmetric.h}}
{\ttfamily \#include $<$stddef.\+h$>$}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include "{}params.\+h"{}}\newline
{\ttfamily \#include "{}fips202.\+h"{}}\newline
{\ttfamily \#include "{}fips202x4.\+h"{}}\newline
Include dependency graph for symmetric.\+h\+:
% FIG 0
This graph shows which files directly or indirectly include this file\+:
% FIG 1
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{symmetric_8h_ac9ab7cc2c410ba09ef3874e60db6f073}{kyber\+\_\+shake128\+\_\+absorb}}~\mbox{\hyperlink{params_8h_a51c1085c773ccaac6cfa51a987dd346b}{KYBER\+\_\+\+NAMESPACE}}(kyber\+\_\+shake128\+\_\+absorb)
\item 
\#define \mbox{\hyperlink{symmetric_8h_acc2b4154079d6441d2ec3aed273d3763}{kyber\+\_\+shake256\+\_\+prf}}~\mbox{\hyperlink{params_8h_a51c1085c773ccaac6cfa51a987dd346b}{KYBER\+\_\+\+NAMESPACE}}(kyber\+\_\+shake256\+\_\+prf)
\item 
\#define \mbox{\hyperlink{symmetric_8h_ac506e9d57c07d1332aabbbcd4e827551}{kyber\+\_\+shake256\+\_\+rkprf}}~\mbox{\hyperlink{params_8h_a51c1085c773ccaac6cfa51a987dd346b}{KYBER\+\_\+\+NAMESPACE}}(kyber\+\_\+shake256\+\_\+rkprf)
\item 
\#define \mbox{\hyperlink{symmetric_8h_a2fc02ca88c8bba410db1e67bbea1156d}{XOF\+\_\+\+BLOCKBYTES}}~\mbox{\hyperlink{fips202_8h_a049b154b3d12b0df19b2c986f458341d}{SHAKE128\+\_\+\+RATE}}
\item 
\#define \mbox{\hyperlink{symmetric_8h_ab01b650d01ece35a2d864e9d2265441a}{hash\+\_\+h}}(OUT,  IN,  INBYTES)~\mbox{\hyperlink{fips202_8h_afbae018ec8ee1f2f678ad4a9100fa4e9}{sha3\+\_\+256}}(OUT, IN, INBYTES)
\item 
\#define \mbox{\hyperlink{symmetric_8h_afb53037bcda697622a1c5d522faecfa6}{hash\+\_\+g}}(OUT,  IN,  INBYTES)~\mbox{\hyperlink{fips202_8h_ac7e9f6c0974148a006c3a22032be74c0}{sha3\+\_\+512}}(OUT, IN, INBYTES)
\item 
\#define \mbox{\hyperlink{symmetric_8h_af8ef6b4a89f9242e903c8685187ef0f4}{xof\+\_\+absorb}}(STATE,  SEED,  X,  Y)~\mbox{\hyperlink{symmetric_8h_ac9ab7cc2c410ba09ef3874e60db6f073}{kyber\+\_\+shake128\+\_\+absorb}}(STATE, SEED, X, Y)
\begin{DoxyCompactList}\small\item\em Absorbs a seed and matrix indices into the state of the SHAKE128 XOF (Extensible Output Function). \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{symmetric_8h_a6e88e8a31d1cc278f777a453e22d35f5}{xof\+\_\+squeezeblocks}}(OUT,  OUTBLOCKS,  STATE)~\mbox{\hyperlink{fips202_8h_a18c5357e566744ef37ac98a476daf323}{shake128\+\_\+squeezeblocks}}(OUT, OUTBLOCKS, STATE)
\begin{DoxyCompactList}\small\item\em Squeezes random blocks of data from the SHAKE128 XOF state into the output buffer. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{symmetric_8h_ac5e5bf1f89e68d3cb382b8427746cb41}{prf}}(OUT,  OUTBYTES,  KEY,  NONCE)~\mbox{\hyperlink{symmetric_8h_acc2b4154079d6441d2ec3aed273d3763}{kyber\+\_\+shake256\+\_\+prf}}(OUT, OUTBYTES, KEY, NONCE)
\item 
\#define \mbox{\hyperlink{symmetric_8h_a454f6e953cfd8ecefa5d10c3506059b1}{rkprf}}(OUT,  KEY,  INPUT)~\mbox{\hyperlink{symmetric_8h_ac506e9d57c07d1332aabbbcd4e827551}{kyber\+\_\+shake256\+\_\+rkprf}}(OUT, KEY, INPUT)
\end{DoxyCompactItemize}
\doxysubsubsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \mbox{\hyperlink{structkeccak__state}{keccak\+\_\+state}} \mbox{\hyperlink{symmetric_8h_a7dac7d19620804387d30236a26ed635d}{xof\+\_\+state}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{symmetric_8h_a8abb0b5edeb92d63c60c89349b75002a}{pqcrystals\+\_\+kyber768\+\_\+avx2\+\_\+kyber\+\_\+shake128\+\_\+absorb}} (\mbox{\hyperlink{structkeccak__state}{keccak\+\_\+state}} \texorpdfstring{$\ast$}{*}s, const uint8\+\_\+t seed\mbox{[}32\mbox{]}, uint8\+\_\+t x, uint8\+\_\+t y)
\item 
void \mbox{\hyperlink{symmetric_8h_a1e92362bef9f5e2f5e87db984e053ece}{pqcrystals\+\_\+kyber768\+\_\+avx2\+\_\+kyber\+\_\+shake256\+\_\+prf}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}out, size\+\_\+t outlen, const uint8\+\_\+t key\mbox{[}32\mbox{]}, uint8\+\_\+t nonce)
\item 
void \mbox{\hyperlink{symmetric_8h_af492bd8ed0aa6404ecd233d87eb93cf3}{pqcrystals\+\_\+kyber768\+\_\+avx2\+\_\+kyber\+\_\+shake256\+\_\+rkprf}} (uint8\+\_\+t out\mbox{[}32\mbox{]}, const uint8\+\_\+t key\mbox{[}32\mbox{]}, const uint8\+\_\+t input\mbox{[}(((3 \texorpdfstring{$\ast$}{*}320)+128))\mbox{]})
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\Hypertarget{symmetric_8h_afb53037bcda697622a1c5d522faecfa6}\label{symmetric_8h_afb53037bcda697622a1c5d522faecfa6} 
\index{symmetric.h@{symmetric.h}!hash\_g@{hash\_g}}
\index{hash\_g@{hash\_g}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{hash\_g}{hash\_g}}
{\footnotesize\ttfamily \#define hash\+\_\+g(\begin{DoxyParamCaption}\item[{}]{OUT,  }\item[{}]{IN,  }\item[{}]{INBYTES }\end{DoxyParamCaption})~\mbox{\hyperlink{fips202_8h_ac7e9f6c0974148a006c3a22032be74c0}{sha3\+\_\+512}}(OUT, IN, INBYTES)}

\Hypertarget{symmetric_8h_ab01b650d01ece35a2d864e9d2265441a}\label{symmetric_8h_ab01b650d01ece35a2d864e9d2265441a} 
\index{symmetric.h@{symmetric.h}!hash\_h@{hash\_h}}
\index{hash\_h@{hash\_h}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{hash\_h}{hash\_h}}
{\footnotesize\ttfamily \#define hash\+\_\+h(\begin{DoxyParamCaption}\item[{}]{OUT,  }\item[{}]{IN,  }\item[{}]{INBYTES }\end{DoxyParamCaption})~\mbox{\hyperlink{fips202_8h_afbae018ec8ee1f2f678ad4a9100fa4e9}{sha3\+\_\+256}}(OUT, IN, INBYTES)}

\Hypertarget{symmetric_8h_ac9ab7cc2c410ba09ef3874e60db6f073}\label{symmetric_8h_ac9ab7cc2c410ba09ef3874e60db6f073} 
\index{symmetric.h@{symmetric.h}!kyber\_shake128\_absorb@{kyber\_shake128\_absorb}}
\index{kyber\_shake128\_absorb@{kyber\_shake128\_absorb}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{kyber\_shake128\_absorb}{kyber\_shake128\_absorb}}
{\footnotesize\ttfamily \#define kyber\+\_\+shake128\+\_\+absorb~\mbox{\hyperlink{params_8h_a51c1085c773ccaac6cfa51a987dd346b}{KYBER\+\_\+\+NAMESPACE}}(kyber\+\_\+shake128\+\_\+absorb)}

\Hypertarget{symmetric_8h_acc2b4154079d6441d2ec3aed273d3763}\label{symmetric_8h_acc2b4154079d6441d2ec3aed273d3763} 
\index{symmetric.h@{symmetric.h}!kyber\_shake256\_prf@{kyber\_shake256\_prf}}
\index{kyber\_shake256\_prf@{kyber\_shake256\_prf}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{kyber\_shake256\_prf}{kyber\_shake256\_prf}}
{\footnotesize\ttfamily \#define kyber\+\_\+shake256\+\_\+prf~\mbox{\hyperlink{params_8h_a51c1085c773ccaac6cfa51a987dd346b}{KYBER\+\_\+\+NAMESPACE}}(kyber\+\_\+shake256\+\_\+prf)}

\Hypertarget{symmetric_8h_ac506e9d57c07d1332aabbbcd4e827551}\label{symmetric_8h_ac506e9d57c07d1332aabbbcd4e827551} 
\index{symmetric.h@{symmetric.h}!kyber\_shake256\_rkprf@{kyber\_shake256\_rkprf}}
\index{kyber\_shake256\_rkprf@{kyber\_shake256\_rkprf}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{kyber\_shake256\_rkprf}{kyber\_shake256\_rkprf}}
{\footnotesize\ttfamily \#define kyber\+\_\+shake256\+\_\+rkprf~\mbox{\hyperlink{params_8h_a51c1085c773ccaac6cfa51a987dd346b}{KYBER\+\_\+\+NAMESPACE}}(kyber\+\_\+shake256\+\_\+rkprf)}

\Hypertarget{symmetric_8h_ac5e5bf1f89e68d3cb382b8427746cb41}\label{symmetric_8h_ac5e5bf1f89e68d3cb382b8427746cb41} 
\index{symmetric.h@{symmetric.h}!prf@{prf}}
\index{prf@{prf}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{prf}{prf}}
{\footnotesize\ttfamily \#define prf(\begin{DoxyParamCaption}\item[{}]{OUT,  }\item[{}]{OUTBYTES,  }\item[{}]{KEY,  }\item[{}]{NONCE }\end{DoxyParamCaption})~\mbox{\hyperlink{symmetric_8h_acc2b4154079d6441d2ec3aed273d3763}{kyber\+\_\+shake256\+\_\+prf}}(OUT, OUTBYTES, KEY, NONCE)}

\Hypertarget{symmetric_8h_a454f6e953cfd8ecefa5d10c3506059b1}\label{symmetric_8h_a454f6e953cfd8ecefa5d10c3506059b1} 
\index{symmetric.h@{symmetric.h}!rkprf@{rkprf}}
\index{rkprf@{rkprf}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{rkprf}{rkprf}}
{\footnotesize\ttfamily \#define rkprf(\begin{DoxyParamCaption}\item[{}]{OUT,  }\item[{}]{KEY,  }\item[{}]{INPUT }\end{DoxyParamCaption})~\mbox{\hyperlink{symmetric_8h_ac506e9d57c07d1332aabbbcd4e827551}{kyber\+\_\+shake256\+\_\+rkprf}}(OUT, KEY, INPUT)}

\Hypertarget{symmetric_8h_af8ef6b4a89f9242e903c8685187ef0f4}\label{symmetric_8h_af8ef6b4a89f9242e903c8685187ef0f4} 
\index{symmetric.h@{symmetric.h}!xof\_absorb@{xof\_absorb}}
\index{xof\_absorb@{xof\_absorb}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{xof\_absorb}{xof\_absorb}}
{\footnotesize\ttfamily \#define xof\+\_\+absorb(\begin{DoxyParamCaption}\item[{}]{STATE,  }\item[{}]{SEED,  }\item[{}]{X,  }\item[{}]{Y }\end{DoxyParamCaption})~\mbox{\hyperlink{symmetric_8h_ac9ab7cc2c410ba09ef3874e60db6f073}{kyber\+\_\+shake128\+\_\+absorb}}(STATE, SEED, X, Y)}



Absorbs a seed and matrix indices into the state of the SHAKE128 XOF (Extensible Output Function). 

This function absorbs the provided seed and the matrix indices ({\ttfamily x} and {\ttfamily y}) into the given XOF state. The absorbed data is used as the basis for generating deterministic random values, which are then squeezed out by the {\ttfamily xof\+\_\+squeezeblocks} function. This operation initializes the internal state of the XOF for subsequent squeezes.

The function uses the {\ttfamily SHAKE128} cryptographic hash function and is commonly used in lattice-\/based cryptography to ensure deterministically generated random values for matrix generation or other cryptographic operations.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em s} & The XOF state to absorb data into. \\
\hline
\mbox{\texttt{ in}}  & {\em seed} & The seed used to initialize the XOF state (KYBER\+\_\+\+SYMBYTES length). \\
\hline
\mbox{\texttt{ in}}  & {\em x} & The x-\/index of the matrix (or other context-\/specific value). \\
\hline
\mbox{\texttt{ in}}  & {\em y} & The y-\/index of the matrix (or other context-\/specific value). \\
\hline
\end{DoxyParams}
\Hypertarget{symmetric_8h_a2fc02ca88c8bba410db1e67bbea1156d}\label{symmetric_8h_a2fc02ca88c8bba410db1e67bbea1156d} 
\index{symmetric.h@{symmetric.h}!XOF\_BLOCKBYTES@{XOF\_BLOCKBYTES}}
\index{XOF\_BLOCKBYTES@{XOF\_BLOCKBYTES}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{XOF\_BLOCKBYTES}{XOF\_BLOCKBYTES}}
{\footnotesize\ttfamily \#define XOF\+\_\+\+BLOCKBYTES~\mbox{\hyperlink{fips202_8h_a049b154b3d12b0df19b2c986f458341d}{SHAKE128\+\_\+\+RATE}}}

\Hypertarget{symmetric_8h_a6e88e8a31d1cc278f777a453e22d35f5}\label{symmetric_8h_a6e88e8a31d1cc278f777a453e22d35f5} 
\index{symmetric.h@{symmetric.h}!xof\_squeezeblocks@{xof\_squeezeblocks}}
\index{xof\_squeezeblocks@{xof\_squeezeblocks}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{xof\_squeezeblocks}{xof\_squeezeblocks}}
{\footnotesize\ttfamily \#define xof\+\_\+squeezeblocks(\begin{DoxyParamCaption}\item[{}]{OUT,  }\item[{}]{OUTBLOCKS,  }\item[{}]{STATE }\end{DoxyParamCaption})~\mbox{\hyperlink{fips202_8h_a18c5357e566744ef37ac98a476daf323}{shake128\+\_\+squeezeblocks}}(OUT, OUTBLOCKS, STATE)}



Squeezes random blocks of data from the SHAKE128 XOF state into the output buffer. 

This function squeezes {\ttfamily OUTBLOCKS} blocks of data from the given XOF state into the output buffer. The data is generated deterministically based on the absorbed seed and matrix indices. The number of bytes squeezed is determined by the {\ttfamily OUTBLOCKS} parameter, which specifies how many blocks of {\ttfamily SHAKE128\+\_\+\+RATE} bytes are output.

This operation is typically used after absorbing the seed and matrix indices via {\ttfamily xof\+\_\+absorb}, and it generates the random values needed for various cryptographic operations (such as matrix generation, key derivation, etc.).


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ out}}  & {\em OUT} & The output buffer where the squeezed data will be stored. \\
\hline
\mbox{\texttt{ in}}  & {\em OUTBLOCKS} & The number of blocks of data to squeeze from the XOF state. \\
\hline
\mbox{\texttt{ in}}  & {\em STATE} & The XOF state from which data will be squeezed (initialized by {\ttfamily xof\+\_\+absorb}). \\
\hline
\end{DoxyParams}


\doxysubsection{Typedef Documentation}
\Hypertarget{symmetric_8h_a7dac7d19620804387d30236a26ed635d}\label{symmetric_8h_a7dac7d19620804387d30236a26ed635d} 
\index{symmetric.h@{symmetric.h}!xof\_state@{xof\_state}}
\index{xof\_state@{xof\_state}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{xof\_state}{xof\_state}}
{\footnotesize\ttfamily typedef \mbox{\hyperlink{structkeccak__state}{keccak\+\_\+state}} \mbox{\hyperlink{symmetric_8h_a7dac7d19620804387d30236a26ed635d}{xof\+\_\+state}}}



\doxysubsection{Function Documentation}
\Hypertarget{symmetric_8h_a8abb0b5edeb92d63c60c89349b75002a}\label{symmetric_8h_a8abb0b5edeb92d63c60c89349b75002a} 
\index{symmetric.h@{symmetric.h}!pqcrystals\_kyber768\_avx2\_kyber\_shake128\_absorb@{pqcrystals\_kyber768\_avx2\_kyber\_shake128\_absorb}}
\index{pqcrystals\_kyber768\_avx2\_kyber\_shake128\_absorb@{pqcrystals\_kyber768\_avx2\_kyber\_shake128\_absorb}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{pqcrystals\_kyber768\_avx2\_kyber\_shake128\_absorb()}{pqcrystals\_kyber768\_avx2\_kyber\_shake128\_absorb()}}
{\footnotesize\ttfamily void pqcrystals\+\_\+kyber768\+\_\+avx2\+\_\+kyber\+\_\+shake128\+\_\+absorb (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structkeccak__state}{keccak\+\_\+state}} \texorpdfstring{$\ast$}{*}}]{s,  }\item[{const uint8\+\_\+t}]{seed\mbox{[}32\mbox{]},  }\item[{uint8\+\_\+t}]{x,  }\item[{uint8\+\_\+t}]{y }\end{DoxyParamCaption})}

\Hypertarget{symmetric_8h_a1e92362bef9f5e2f5e87db984e053ece}\label{symmetric_8h_a1e92362bef9f5e2f5e87db984e053ece} 
\index{symmetric.h@{symmetric.h}!pqcrystals\_kyber768\_avx2\_kyber\_shake256\_prf@{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_prf}}
\index{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_prf@{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_prf}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_prf()}{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_prf()}}
{\footnotesize\ttfamily void pqcrystals\+\_\+kyber768\+\_\+avx2\+\_\+kyber\+\_\+shake256\+\_\+prf (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{out,  }\item[{size\+\_\+t}]{outlen,  }\item[{const uint8\+\_\+t}]{key\mbox{[}32\mbox{]},  }\item[{uint8\+\_\+t}]{nonce }\end{DoxyParamCaption})}

\Hypertarget{symmetric_8h_af492bd8ed0aa6404ecd233d87eb93cf3}\label{symmetric_8h_af492bd8ed0aa6404ecd233d87eb93cf3} 
\index{symmetric.h@{symmetric.h}!pqcrystals\_kyber768\_avx2\_kyber\_shake256\_rkprf@{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_rkprf}}
\index{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_rkprf@{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_rkprf}!symmetric.h@{symmetric.h}}
\doxysubsubsection{\texorpdfstring{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_rkprf()}{pqcrystals\_kyber768\_avx2\_kyber\_shake256\_rkprf()}}
{\footnotesize\ttfamily void pqcrystals\+\_\+kyber768\+\_\+avx2\+\_\+kyber\+\_\+shake256\+\_\+rkprf (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{out\mbox{[}32\mbox{]},  }\item[{const uint8\+\_\+t}]{key\mbox{[}32\mbox{]},  }\item[{const uint8\+\_\+t}]{input\mbox{[}(((3 \texorpdfstring{$\ast$}{*}320)+128))\mbox{]} }\end{DoxyParamCaption})}

