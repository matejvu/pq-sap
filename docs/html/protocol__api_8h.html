<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: src/protocol_api.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">protocol_api.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Header file containing functions and constants for SAP protocol operations (MLWE PQ SAP).  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="params_8h_source.html">params.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="poly_8h_source.html">poly.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="polyvec_8h_source.html">polyvec.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="indcpa_8h_source.html">indcpa.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="kem_8h_source.html">kem.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fips202_8h_source.html">fips202.h</a>&quot;</code><br />
<code>#include &quot;fips202x4.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for protocol_api.h:</div>
<div class="dyncontent">
<div class="center"><img src="protocol__api_8h__incl.png" border="0" usemap="#asrc_2protocol__api_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="protocol__api_8h__dep__incl.png" border="0" usemap="#asrc_2protocol__api_8hdep" alt=""/></div>
</div>
</div>
<p><a href="protocol__api_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad5efc07c6661656b396c6c3e859e0e74" id="r_ad5efc07c6661656b396c6c3e859e0e74"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#ad5efc07c6661656b396c6c3e859e0e74">PUBLIC_KEY_BYTES</a>&#160;&#160;&#160;<a class="el" href="params_8h.html#a7663b32715a32f12eb70420793753ce3">KYBER_PUBLICKEYBYTES</a></td></tr>
<tr class="memdesc:ad5efc07c6661656b396c6c3e859e0e74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes in a public key.  <br /></td></tr>
<tr class="separator:ad5efc07c6661656b396c6c3e859e0e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c301f8e1f57a825bbd2dcab697fc5e" id="r_a84c301f8e1f57a825bbd2dcab697fc5e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#a84c301f8e1f57a825bbd2dcab697fc5e">CIPHERTEXT_BYTES</a>&#160;&#160;&#160;<a class="el" href="params_8h.html#a356cca49fc302b0c34c18f4bbda6e5fe">KYBER_CIPHERTEXTBYTES</a></td></tr>
<tr class="memdesc:a84c301f8e1f57a825bbd2dcab697fc5e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes in a ciphertext.  <br /></td></tr>
<tr class="separator:a84c301f8e1f57a825bbd2dcab697fc5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f2c416c5b669c62894a54d8c26c33b" id="r_ab3f2c416c5b669c62894a54d8c26c33b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#ab3f2c416c5b669c62894a54d8c26c33b">SECRET_KEY_BYTES</a>&#160;&#160;&#160;<a class="el" href="params_8h.html#a7f9a2f9ae6937442f988816af97babb3">KYBER_SECRETKEYBYTES</a></td></tr>
<tr class="memdesc:ab3f2c416c5b669c62894a54d8c26c33b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes in a secret key.  <br /></td></tr>
<tr class="separator:ab3f2c416c5b669c62894a54d8c26c33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac42ee8dc097e52d63dd4e8371d769d12" id="r_ac42ee8dc097e52d63dd4e8371d769d12"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#ac42ee8dc097e52d63dd4e8371d769d12">STEALTH_ADDRESS_BYTES</a>&#160;&#160;&#160;(<a class="el" href="params_8h.html#a1e66e19d25aceeae49d1184a077f92db">KYBER_K</a> * <a class="el" href="params_8h.html#af66bcd4f5c1ee3377ed637b38ed8f356">KYBER_POLYBYTES</a>)</td></tr>
<tr class="memdesc:ac42ee8dc097e52d63dd4e8371d769d12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes in a stealth address.  <br /></td></tr>
<tr class="separator:ac42ee8dc097e52d63dd4e8371d769d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0666dc127dc023e0ab7c99df84cee1c6" id="r_a0666dc127dc023e0ab7c99df84cee1c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#a0666dc127dc023e0ab7c99df84cee1c6">SS_BYTES</a>&#160;&#160;&#160;<a class="el" href="params_8h.html#a5054c9269277412d8536eb82cfffbe15">KYBER_SSBYTES</a></td></tr>
<tr class="memdesc:a0666dc127dc023e0ab7c99df84cee1c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes in a shared secret.  <br /></td></tr>
<tr class="separator:a0666dc127dc023e0ab7c99df84cee1c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2a804d61df9a40fc309e6c609739110d" id="r_a2a804d61df9a40fc309e6c609739110d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#a2a804d61df9a40fc309e6c609739110d">calculate_stealth_pub_key</a> (uint8_t stealth_pub_key[(<a class="el" href="params_8h.html#a1e66e19d25aceeae49d1184a077f92db">KYBER_K</a> *<a class="el" href="params_8h.html#af66bcd4f5c1ee3377ed637b38ed8f356">KYBER_POLYBYTES</a>)], const uint8_t ss[<a class="el" href="params_8h.html#a132bbc78e88ea5e14e93e0963dd5d0f9">KYBER_SYMBYTES</a>], const uint8_t k_pub[<a class="el" href="params_8h.html#a4c9f2345946a0d01dc2051b493c2bda4">KYBER_INDCPA_PUBLICKEYBYTES</a>])</td></tr>
<tr class="memdesc:a2a804d61df9a40fc309e6c609739110d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the public key of the stealth address.  <br /></td></tr>
<tr class="separator:a2a804d61df9a40fc309e6c609739110d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858f8d44b117050df006c629482959fc" id="r_a858f8d44b117050df006c629482959fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#a858f8d44b117050df006c629482959fc">recipient_computes_stealth_pub_key</a> (uint8_t stealth_pub_key[(<a class="el" href="params_8h.html#a1e66e19d25aceeae49d1184a077f92db">KYBER_K</a> *<a class="el" href="params_8h.html#af66bcd4f5c1ee3377ed637b38ed8f356">KYBER_POLYBYTES</a>)], const uint8_t k_pub[<a class="el" href="params_8h.html#a7663b32715a32f12eb70420793753ce3">KYBER_PUBLICKEYBYTES</a>], const uint8_t ephemeral_pub_key[<a class="el" href="params_8h.html#a356cca49fc302b0c34c18f4bbda6e5fe">KYBER_CIPHERTEXTBYTES</a>], const uint8_t v[<a class="el" href="params_8h.html#a7f9a2f9ae6937442f988816af97babb3">KYBER_SECRETKEYBYTES</a>])</td></tr>
<tr class="memdesc:a858f8d44b117050df006c629482959fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the stealth public key by the recipient.  <br /></td></tr>
<tr class="separator:a858f8d44b117050df006c629482959fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a741d56808420f6e2ee9e851f4122dae0" id="r_a741d56808420f6e2ee9e851f4122dae0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#a741d56808420f6e2ee9e851f4122dae0">sender_computes_stealth_pub_key_and_viewtag</a> (uint8_t stealth_pub_key[(<a class="el" href="params_8h.html#a1e66e19d25aceeae49d1184a077f92db">KYBER_K</a> *<a class="el" href="params_8h.html#af66bcd4f5c1ee3377ed637b38ed8f356">KYBER_POLYBYTES</a>)], uint8_t ephemeral_pub_key[<a class="el" href="params_8h.html#a356cca49fc302b0c34c18f4bbda6e5fe">KYBER_CIPHERTEXTBYTES</a>], uint8_t *view_tag, const uint8_t v_pub[<a class="el" href="params_8h.html#a7663b32715a32f12eb70420793753ce3">KYBER_PUBLICKEYBYTES</a>], const uint8_t k_pub[<a class="el" href="params_8h.html#a7663b32715a32f12eb70420793753ce3">KYBER_PUBLICKEYBYTES</a>])</td></tr>
<tr class="memdesc:a741d56808420f6e2ee9e851f4122dae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the stealth public key and view tag by the sender.  <br /></td></tr>
<tr class="separator:a741d56808420f6e2ee9e851f4122dae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a43976b56c90c6d13ef53bda55a3d34" id="r_a9a43976b56c90c6d13ef53bda55a3d34"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="protocol__api_8h.html#a9a43976b56c90c6d13ef53bda55a3d34">calculate_view_tag</a> (const uint8_t ss[<a class="el" href="params_8h.html#a5054c9269277412d8536eb82cfffbe15">KYBER_SSBYTES</a>])</td></tr>
<tr class="memdesc:a9a43976b56c90c6d13ef53bda55a3d34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates a view tag from a shared secret.  <br /></td></tr>
<tr class="separator:a9a43976b56c90c6d13ef53bda55a3d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file containing functions and constants for SAP protocol operations (MLWE PQ SAP). </p>
<p>This file provides the function declarations and macro definitions needed for both sender and recipient to complete stealth address generation and key exchanges according to the SAP protocol based on Kyber primitives. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a84c301f8e1f57a825bbd2dcab697fc5e" name="a84c301f8e1f57a825bbd2dcab697fc5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84c301f8e1f57a825bbd2dcab697fc5e">&#9670;&#160;</a></span>CIPHERTEXT_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIPHERTEXT_BYTES&#160;&#160;&#160;<a class="el" href="params_8h.html#a356cca49fc302b0c34c18f4bbda6e5fe">KYBER_CIPHERTEXTBYTES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes in a ciphertext. </p>

</div>
</div>
<a id="ad5efc07c6661656b396c6c3e859e0e74" name="ad5efc07c6661656b396c6c3e859e0e74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5efc07c6661656b396c6c3e859e0e74">&#9670;&#160;</a></span>PUBLIC_KEY_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PUBLIC_KEY_BYTES&#160;&#160;&#160;<a class="el" href="params_8h.html#a7663b32715a32f12eb70420793753ce3">KYBER_PUBLICKEYBYTES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes in a public key. </p>

</div>
</div>
<a id="ab3f2c416c5b669c62894a54d8c26c33b" name="ab3f2c416c5b669c62894a54d8c26c33b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3f2c416c5b669c62894a54d8c26c33b">&#9670;&#160;</a></span>SECRET_KEY_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SECRET_KEY_BYTES&#160;&#160;&#160;<a class="el" href="params_8h.html#a7f9a2f9ae6937442f988816af97babb3">KYBER_SECRETKEYBYTES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes in a secret key. </p>

</div>
</div>
<a id="a0666dc127dc023e0ab7c99df84cee1c6" name="a0666dc127dc023e0ab7c99df84cee1c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0666dc127dc023e0ab7c99df84cee1c6">&#9670;&#160;</a></span>SS_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SS_BYTES&#160;&#160;&#160;<a class="el" href="params_8h.html#a5054c9269277412d8536eb82cfffbe15">KYBER_SSBYTES</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes in a shared secret. </p>

</div>
</div>
<a id="ac42ee8dc097e52d63dd4e8371d769d12" name="ac42ee8dc097e52d63dd4e8371d769d12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac42ee8dc097e52d63dd4e8371d769d12">&#9670;&#160;</a></span>STEALTH_ADDRESS_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define STEALTH_ADDRESS_BYTES&#160;&#160;&#160;(<a class="el" href="params_8h.html#a1e66e19d25aceeae49d1184a077f92db">KYBER_K</a> * <a class="el" href="params_8h.html#af66bcd4f5c1ee3377ed637b38ed8f356">KYBER_POLYBYTES</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes in a stealth address. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2a804d61df9a40fc309e6c609739110d" name="a2a804d61df9a40fc309e6c609739110d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a804d61df9a40fc309e6c609739110d">&#9670;&#160;</a></span>calculate_stealth_pub_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calculate_stealth_pub_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>stealth_pub_key</em>[(KYBER_K *KYBER_POLYBYTES)], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>ss</em>[KYBER_SYMBYTES], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>k_pub</em>[KYBER_INDCPA_PUBLICKEYBYTES]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the public key of the stealth address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">stealth_pub_key</td><td>Array where the computed stealth public key will be stored (STEALTH_ADDRESS_BYTES). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ss</td><td>Shared secret derived from key exchange. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k_pub</td><td>Recipient's public spending key (KYBER_INDCPA_PUBLICKEYBYTES).</td></tr>
  </table>
  </dd>
</dl>
<p>Calculates the public key of the stealth address.</p>
<ol type="1">
<li>Initializes polyvec structures.<ul>
<li>This step initializes the polyvec structures pkpv and skpv. These structures hold polynomial vectors, and each polynomial is essentially a vector of coefficients used in lattice-based cryptography.The public_seed is initialized to zero here, which will later be used to derive the public key.</li>
</ul>
</li>
<li>Unpacks recipient's public key using <a class="el" href="indcpa_8h.html#a0b1c9afb8ba4870a733d4f675c8028a9" title="De-serialize public key from a byte array; approximate inverse of pack_pk.">unpack_pk(&amp;pkpv, public_seed, k_pub)</a> .The unpacked public key is stored in <code>pkpv</code>.</li>
<li>Derives matrix A deterministically using <a class="el" href="indcpa_8h.html#a95867e1475dc47314959ced95627df2c" title="Generate the matrix A or A^T - USED.">gen_matrix(a, public_seed, 0)</a> .<ul>
<li>The <a class="el" href="indcpa_8h.html#a95867e1475dc47314959ced95627df2c" title="Generate the matrix A or A^T - USED.">gen_matrix()</a> function fills in the matrix a with polynomials where the coefficients are derived from a cryptographic randomness function <a class="el" href="symmetric_8h.html#a6e88e8a31d1cc278f777a453e22d35f5" title="Squeezes random blocks of data from the SHAKE128 XOF state into the output buffer.">xof_squeezeblocks()</a></li>
</ul>
</li>
<li>Converts shared secret into a noise sampled secret key vector <code>skpv</code> using <a class="el" href="poly_8h.html#a7acff2171f8515dcda521e0abce1f164" title="Generates noise (eta1) for a polynomial using a seed and nonce.">poly_getnoise_eta1()</a> .</li>
<li>Computes A * S + K polynomial vector:<ul>
<li>Calls <a class="el" href="polyvec_8h.html#a5ef9e3b32a6e413955076778ca9f056f" title="Performs base multiplication and accumulation in Montgomery form on two polynomial vectors.">polyvec_basemul_acc_montgomery()</a> and <a class="el" href="poly_8h.html#a245ca8de277f9a977284c692163f3f93" title="Converts a polynomial to Montgomery form.">poly_tomont()</a> for each element.</li>
</ul>
</li>
<li>Adds original public key polynomial and reduces ( <a class="el" href="polyvec_8h.html#afeba48290257815f6213f9812426fe8d" title="Adds two polynomial vectors.">polyvec_add(&amp;p_poly, &amp;p_poly, &amp;pkpv)</a> <a class="el" href="polyvec_8h.html#a0ee7c5915d658a6b2d9e69c62aa35162" title="Reduces the coefficients of a polynomial vector.">polyvec_reduce(&amp;p_poly)</a> ).</li>
<li>Converts resulting polynomial vector into byte array using <a class="el" href="polyvec_8h.html#a68bc449baca16c3d14c221146fed8a62" title="Converts a polynomial vector into a byte array.">polyvec_tobytes(stealth_pub_key, &amp;p_poly)</a>.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">stealth_pub_key</td><td>Output array for stealth public key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ss</td><td>Shared secret. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k_pub</td><td>Recipient's public spending key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9a43976b56c90c6d13ef53bda55a3d34" name="a9a43976b56c90c6d13ef53bda55a3d34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a43976b56c90c6d13ef53bda55a3d34">&#9670;&#160;</a></span>calculate_view_tag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t calculate_view_tag </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>ss</em>[KYBER_SSBYTES]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates a view tag from a shared secret. </p>
<p>The view tag is used to quickly identify transactions meant for the recipient.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ss</td><td>Shared secret. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>View tag as a single byte.</dd></dl>
<p>Calculates a view tag from a shared secret.</p>
<ol type="1">
<li>Calls <a class="el" href="fips202_8h.html#a503922aece24ae8b03030593676c4ce2" title="Computes the SHAKE128 extendable-output function (XOF) on input data.">shake128(hash, 32, ss, KYBER_SSBYTES)</a> to hash the shared secret into 32 bytes.</li>
<li>Takes the first byte of the hash as the view tag.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ss</td><td>Shared secret. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t View tag (single byte). </dd></dl>

</div>
</div>
<a id="a858f8d44b117050df006c629482959fc" name="a858f8d44b117050df006c629482959fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858f8d44b117050df006c629482959fc">&#9670;&#160;</a></span>recipient_computes_stealth_pub_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recipient_computes_stealth_pub_key </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>stealth_pub_key</em>[(KYBER_K *KYBER_POLYBYTES)], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>k_pub</em>[KYBER_PUBLICKEYBYTES], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>ephemeral_pub_key</em>[KYBER_CIPHERTEXTBYTES], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>v</em>[KYBER_SECRETKEYBYTES]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the stealth public key by the recipient. </p>
<p>The recipient uses their secret view key and the sender's ephemeral public key to compute the stealth address.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">stealth_pub_key</td><td>Array where the computed stealth public key will be stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k_pub</td><td>Sender's public key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ephemeral_pub_key</td><td>Sender's ephemeral public key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Recipient's secret view key.</td></tr>
  </table>
  </dd>
</dl>
<p>Computes the stealth public key by the recipient.</p>
<ol type="1">
<li>Calls <a class="el" href="kem_8h.html#a08dbb674e5d520aca994bc4472ce5a02" title="Decrypts the ciphertext using the secret key and generates the shared secret.">crypto_kem_dec(ss, ephemeral_pub_key, v)</a> to derive shared secret <code>ss</code> from ephemeral public key and private key <code>v</code>.</li>
<li>Prints recipient's public key and derived shared secret.</li>
<li>Calls <a class="el" href="protocol__api_8h.html#a2a804d61df9a40fc309e6c609739110d" title="Calculates the public key of the stealth address.">calculate_stealth_pub_key()</a> to compute stealth public key using public key <code>k_pub</code> and shared secret <code>ss</code>. The resulting stealth public key is written into the output parameter <code>stealth_pub_key</code>.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">stealth_pub_key</td><td>Output array for the computed stealth public key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k_pub</td><td>Recipient's public spending key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ephemeral_pub_key</td><td>Ephemeral public key received from the sender. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>Recipient's private "view" key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a741d56808420f6e2ee9e851f4122dae0" name="a741d56808420f6e2ee9e851f4122dae0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a741d56808420f6e2ee9e851f4122dae0">&#9670;&#160;</a></span>sender_computes_stealth_pub_key_and_viewtag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sender_computes_stealth_pub_key_and_viewtag </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>stealth_pub_key</em>[(KYBER_K *KYBER_POLYBYTES)], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>ephemeral_pub_key</em>[KYBER_CIPHERTEXTBYTES], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>view_tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>v_pub</em>[KYBER_PUBLICKEYBYTES], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>k_pub</em>[KYBER_PUBLICKEYBYTES]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the stealth public key and view tag by the sender. </p>
<p>The sender generates an ephemeral key pair, derives a shared secret, computes the stealth address, and extracts a view tag.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">stealth_pub_key</td><td>Array where the computed stealth public key will be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ephemeral_pub_key</td><td>Array where the ephemeral public key will be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">view_tag</td><td>Computed view tag. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_pub</td><td>Recipient's public view key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k_pub</td><td>Sender's public key.</td></tr>
  </table>
  </dd>
</dl>
<p>Computes the stealth public key and view tag by the sender.</p>
<ol type="1">
<li>Validates input.</li>
<li>Calls <a class="el" href="kem_8h.html#a34799e9bffdfd9786a5fcd8867837c74" title="Encrypts data using the public key.">crypto_kem_enc(ephemeral_pub_key, ss, v_pub)</a> to generate shared secret <code>ss</code> and ephemeral public key.</li>
<li>Prints sender's public key and derived shared secret.</li>
<li>Calls <a class="el" href="protocol__api_8h.html#a2a804d61df9a40fc309e6c609739110d" title="Calculates the public key of the stealth address.">calculate_stealth_pub_key()</a> to compute stealth public key using public key <code>k_pub</code> and shared secret <code>ss</code>. The resulting stealth public key is written into the output parameter <code>stealth_pub_key</code>.</li>
<li>Calls <a class="el" href="protocol__api_8h.html#a9a43976b56c90c6d13ef53bda55a3d34" title="Calculates a view tag from a shared secret.">calculate_view_tag()</a> to compute view tag from shared secret <code>ss</code>.</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">stealth_pub_key</td><td>Output array for computed stealth public key. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ephemeral_pub_key</td><td>Output ephemeral public key (to be sent to recipient). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">view_tag</td><td>Output computed view tag (single byte). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v_pub</td><td>Recipient's public "view" key. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">k_pub</td><td>Recipient's public "spending" key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
