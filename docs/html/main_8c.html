<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">main.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="kem_8h_source.html">kem.h</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for main.c:</div>
<div class="dyncontent">
<div class="center"><img src="main_8c__incl.png" border="0" usemap="#amain_8c" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af2b06c0675671c7d946efdc4daf30946" id="r_af2b06c0675671c7d946efdc4daf30946"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#af2b06c0675671c7d946efdc4daf30946">print_hex</a> (const char *label, const uint8_t *data, size_t len)</td></tr>
<tr class="memdesc:af2b06c0675671c7d946efdc4daf30946"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to print a byte array as a hexadecimal string.  <br /></td></tr>
<tr class="separator:af2b06c0675671c7d946efdc4daf30946"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66f6b31b5ad750f1fe042a706a4e3d4" id="r_ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a> ()</td></tr>
<tr class="memdesc:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function that runs the Kyber Key Encapsulation Mechanism (KEM) and demonstrates key generation, encapsulation, and decapsulation.  <br /></td></tr>
<tr class="separator:ae66f6b31b5ad750f1fe042a706a4e3d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae66f6b31b5ad750f1fe042a706a4e3d4" name="ae66f6b31b5ad750f1fe042a706a4e3d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66f6b31b5ad750f1fe042a706a4e3d4">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main function that runs the Kyber Key Encapsulation Mechanism (KEM) and demonstrates key generation, encapsulation, and decapsulation. </p>
<p>This function orchestrates the entire process of Kyber's Key Encapsulation Mechanism (KEM), starting from the generation of key pairs, followed by the encapsulation and decapsulation of shared secrets. The main purpose of this test is to verify the correctness of the Kyber encryption and decryption cycle.</p>
<p>The following variables are used in this function:</p><ul>
<li>pk[<a class="el" href="params_8h.html#a7663b32715a32f12eb70420793753ce3" title="The number of bytes used for the public key in the Kyber scheme.">KYBER_PUBLICKEYBYTES</a>]: Public key used for encryption and encapsulation.</li>
<li>sk[<a class="el" href="params_8h.html#a7f9a2f9ae6937442f988816af97babb3" title="The number of bytes used for the secret key in the Kyber scheme.">KYBER_SECRETKEYBYTES</a>]: Secret key used for decryption and decapsulation.</li>
<li>ct[<a class="el" href="params_8h.html#a356cca49fc302b0c34c18f4bbda6e5fe" title="The number of bytes used for the ciphertext in the Kyber scheme.">KYBER_CIPHERTEXTBYTES</a>]: Ciphertext, the encrypted version of the shared secret.</li>
<li>ss1[<a class="el" href="params_8h.html#a5054c9269277412d8536eb82cfffbe15" title="The size in bytes of the shared key in the Kyber algorithm.">KYBER_SSBYTES</a>]: Shared secret from encapsulation.</li>
<li>ss2[<a class="el" href="params_8h.html#a5054c9269277412d8536eb82cfffbe15" title="The size in bytes of the shared key in the Kyber algorithm.">KYBER_SSBYTES</a>]: Shared secret from decapsulation. The main function performs the following steps:</li>
</ul>
<ol type="1">
<li>It generates a public and secret key pair using the Kyber KEM key generation function ( <a class="el" href="kem_8h.html#affcceebbb34b0fcdd82918c9dd6f80ef" title="Generates a public and secret key for Kyber KEM.">crypto_kem_keypair(pk, sk)</a> )</li>
<li>It encapsulates a shared secret using the public key to create a ciphertext and a shared secret ( <a class="el" href="kem_8h.html#a34799e9bffdfd9786a5fcd8867837c74" title="Encrypts data using the public key.">crypto_kem_enc(ct, ss1, pk)</a> ).</li>
<li>It decapsulates the ciphertext using the secret key to recover the shared secret ( <a class="el" href="kem_8h.html#a08dbb674e5d520aca994bc4472ce5a02" title="Decrypts the ciphertext using the secret key and generates the shared secret.">crypto_kem_dec(ss2, ct, sk)</a> ).</li>
<li>It compares the encapsulated and decapsulated shared secrets to ensure they match.</li>
<li>It prints the number of bytes required for the ciphertext in the Kyber scheme.</li>
<li>It prints the result of the test, whether it passed or failed based on the shared secret comparison. This function outputs:</li>
</ol>
<ul>
<li>The public and secret keys in hexadecimal format.</li>
<li>The ciphertext and the two shared secrets (one from encapsulation and one from decapsulation).</li>
<li>A message indicating whether the test passed or failed.</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>0 if the test passes, indicating successful execution; otherwise, it returns early on failure. </dd></dl>

</div>
</div>
<a id="af2b06c0675671c7d946efdc4daf30946" name="af2b06c0675671c7d946efdc4daf30946"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b06c0675671c7d946efdc4daf30946">&#9670;&#160;</a></span>print_hex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_hex </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function to print a byte array as a hexadecimal string. </p>
<p>This function takes a label and a byte array of a given length and prints the bytes in hexadecimal format. It is useful for debugging and viewing raw cryptographic data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">label</td><td>A label that will be printed before the byte array for identification. </td></tr>
    <tr><td class="paramname">data</td><td>The byte array to print. </td></tr>
    <tr><td class="paramname">len</td><td>The length of the byte array. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
